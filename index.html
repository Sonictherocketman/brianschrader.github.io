<!DOCTYPE html>
<html lang="en">
  <head>
    <title>BiteofanApple</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="webmention" href="https://pine.blog/api/webmention/r/f4ecb3b3-6edc-4baa-9553-4f678c3e4b96" />
    <link rel="icon" type="image/png" href="//www.gravatar.com/avatar/11b074a636e00292c98e3e60f7e16595?size=30">
    <link rel="stylesheet" type="text/css" href="/bin/css/stylesheet.css">
    <link rel="stylesheet" type="text/css" href="/bin/css/mobile.css">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml"/>
    <link rel="alternate" type="application/json" title="JSON Feed" href="/feed.json"/>
    
	<meta property="og:type" content="article" />
  <link rel="authorization_endpoint" href="https://indielogin.com/auth"/>
  <link rel="token_endpoint" href="https://tokens.indieauth.com/token"/>

  </head>
  <body>
    <div id="content">
      <div class="nav-container">
  <nav class="nav">
    <div class="nav-item nav-brand">
      <a href="/" class="site-title">
        BiteofanApple
      </a>
      <span
        class="author-tag hide-on-mobile"
      >
        by <a href="/about/">Brian Schrader</a>
      </span>
    </div>
    <div class="nav-item"><a href="/archive/">Archive</a></div>
    <div class="nav-item"><a href="/about/">About</a></div>
    <div class="nav-item"><a href="https://skyrocket.software">Apps</a></div>
    <div class="nav-item"><a href="https://pine.blog/u/sonicrocketman">Microblog</a></div>
  </nav>
</div>
      
  <div class="bars">
    <div class="main-bar">
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/using-pushover-for-super-simple-sysadmin-alerts/" class="u-url p-name">
                Using Pushover For Super Simple Sysadmin Alerts
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-04-27T23:36:00-08:00">
                Posted on Wed, 27 Apr 2022 at 11:36 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>For those who don't know, <a href="https://pushover.net">Pushover</a> is a really great tool that allows users to easily set up and send push notifications to a smartphone. The setup is super simple, and all you need is their app and a little scripting know-how.</p>
<p>I've used Pushover for years to help me monitor my apps and services, and over the years my uses for Pushover have evolved and grown more and more integral to my ability to keep track of the various apps I run. To me, Pushover has gone from a nice-to-have integration to an absolute necessity.</p>
<p>I use Pushover to alert me of all kinds of things. Just to give you an idea, here are a few examples of some of the things I currently use Pushover for:</p>
<ul>
<li>Potential queue backups in <a href="https://pine.blog">Pine.blog</a></li>
<li>Reporting daily user signups for <a href="https://nine9s.cloud">Nine9s</a></li>
<li>Alerts when critical background jobs fail</li>
<li>Alerts when nightly builds fail to deploy</li>
<li>Alerts when a manually-run, long-running job completes</li>
</ul>
<p>Because Pushover is so easy to integrate with basically any codebase (and even one-off shell scripts) I use it all the time for everything from simple alerts to complex and critical reports.</p>
<p>One particular use I'd like to call out from that list above is the nightly build alerts. <a href="https://adventurerscodex.com">Adventurer's Codex</a> has a test environment that we use to sanity check our code before a full deploy. We used to have the test environment redeploy after every single merged pull request, but that system proved incredibly fickle and error prone, so we switched to a simple nightly build. The issue with any automatic build system is that unless you have a detailed live dashboard of deployment statuses (which we do not) it's hard to know if/when a given build has finished deploying or if it encountered an error. That's where Pushover comes in.</p>
<details><summary>Nightly Build and Deploy Script</summary>
<hr />
<p>This script runs as a cron job every night. It attempts to deploy the latest version of the application and if that fails it sends a notification to Pushover.</p>
<code><pre>PUSHOVER_USER="xxxx"
PUSHOVER_KEY="xxx"
PUSHOVER_URL="https://api.pushover.net/1/messages.json"

TITLE="AC Nightly: Build Failed to Deploy"
MESSAGE="The latest build on Nightly has failed."

log() {
  echo "[$(date)] $@";
}

alert_admins() {
  curl -X POST $PUSHOVER_URL \
    -H "Content-Type: application/json" \
    -d "{\"title\": \"$TITLE\", \"message\": \"$MESSAGE\", \
        \"user\": \"$PUSHOVER_USER\", \"token\": \"$PUSHOVER_KEY\"}"
}

./docker-bootstrap.sh upgrade --env nightly
STATUS=$?

if [ $STATUS -eq 0 ]; then
  log "🚀 Build completed successfully!"
else
  log "Uh oh. There was an issue. Alert the admins!"
  alert_admins
fi</pre></code>
</details>

<p>My nightly build script for Adventurer's Codex includes a section after the deployment has completed that checkes the status code of the deploy command and if it is not 0 (i.e. it failed) then it sends me a notification. Bam! Now, every morning that I don't get a notification, I know things are working as intended. If I ever wake up to a notification, then I know I have work to do.</p>
<h3>What Happens in the Background is Ignored in the Background</h3>
<p>Crucially, I use Pushover to alert me about problems with background tasks. Modern web apps include lots of always-running or periodic asynchronous behavior, and because &mdash; when they fail &mdash; they don't directly result in user feedback or a big, loud error page mistakes, bottlenecks, and bugs often go unnoticed or unaccounted for.</p>
<p>Pushover solves those issues. It's trivial to write code that checks for bad behavior or that catches difficult-to-reach-but-critical bugs and just send off a notification.</p>
<p>I used to use email for this sort of thing, and while email is still a good solution, the setup is actually more involved. Most VPSs aren't allowed to send emails directly anymore (due to concerns over spam) and configuring an email provider is just as much work if not slightly more work than using Pushover. In some cases email is more flexible and might be better for larger teams, but I almost always reach for Pushover these days instead of email.</p>
<p>It's just that good.</p>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/crossing-the-wording-threshold/" class="u-url p-name">
                Crossing The Wording Threshold
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-04-27T03:07:00-08:00">
                Posted on Wed, 27 Apr 2022 at 03:07 AM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>A few years ago, I wrote <a href="/archive/so-many-words-written-so-many-more-to-come/">a post</a> about the number of words this blog contained. Well, that was then; this is now, and those counts have changed pretty drastically in the intervening time.</p>
<p>Using the same method as before, I can now report that this blog contains just over 100,000 words spread across 270 posts! A pretty significant achievement.</p>
<pre><code>$ find archive/ -name "*.md"|xargs -I {} cat {} | wc -w
  101042
</code></pre>
<p>I also remade the previous graph for comparison.</p>
<p><img alt="A histogram of the binned words per post" src="/images/blog/words-per-post-2.png" /></p>
<p>It seems like I've written more 300-400 word posts than before which explains the smoothing out in the middle section of the chart.</p>
<p>For those keeping score at home, the new longest post is <a href="/archive/mygenerank-behind-the-scenes-of-the-newest-researchkit-app/">this one</a> from 2017.</p>
<h3>A Terrifying Realization</h3>
<p>It occurred to me that my last post about this topic was back in 2017&mdash;5 years ago!&mdash;and that means I'm very quickly approaching my 10 year blogging anniversary.<sup>1</sup> It's hard to believe it's been so long, but I guess it has.</p>
<p>The first post on this site was back in December of 2012, which is just months away. I'll save the reminiscing for the retrospective post, but for now I'll just admit that it's a lovely coincidence that I reached 100,000 words on my 10 year anniversary.</p>
<div class="footnote">
<sup>1</sup> If you count my first two blogs (which are now gone from the web) it has already been ten years, but let's not do that.
</div>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/that-time-i-lost-control-of-a-server/" class="u-url p-name">
                That Time I Lost Control Of A Server
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-04-19T00:10:00-08:00">
                Posted on Tue, 19 Apr 2022 at 12:10 AM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>Good security hygiene is essential for software developers. The thing is: we tell ourselves that, but rarely ever do we actually experience the effects of bad security hygiene. While deterrence is the point of good hygiene, it's helpful to walk through the real world consequences of bad hygiene and not just talk about the theoretical side of things.</p>
<p>So let's talk about the time one of my servers was hijacked.</p>
<details open><summary>Disclaimer</summary>
<hr />
Right off the bat I need to note that the server in this story was not connected to any product or service that my company, <a href="https://skyrocket.software" title="SkyRocket Software">SkyRocket Software</a>, runs. This was a personal toy server that had no connection with anything I make or sell.
</details>

<h3>The Story</h3>
<p>I've run servers for lots of projects over the years. I manage servers for <a href="https://pine.blog">Pine.blog</a>, <a href="https://nine9s.cloud">Nine9.cloud</a>, <a href="https://d20.photos">d20.photos</a>, and <a href="https://adventurerscodex.com">Adventurer's Codex</a>. I also run several servers for client projects, this blog, and for toy projects. One of those toy projects is a server for an annual holiday Minecraft extravaganza with some friends of mine.</p>
<p>Once long ago, I was going through the process of setting up a new Minecraft server (this was before Linode provided easy-to-deploy Minecraft servers). I wanted to set up the server before going out that evening, and so I was in a bit of a rush. Being in a rush, I didn't bother to set up the server according to Linode's excellent guide on <a href="https://www.linode.com/docs/guides/set-up-and-secure/">Securing Your Server</a>. Instead, I just set a <del>short</del> trivially guessable root password, logged in as root, and got to installing Minecraft.</p>
<p>About halfway through the process I needed to leave, so I disconnected from the server and went to dinner.</p>
<p>When I returned home that night, I found an email in my inbox from Linode telling me that my server had been forcibly shut down because they'd determined that it was being used to send spam emails and help DDOS another site.</p>
<p>I had been gone only about three hours, but it had taken <strong>less than one hour</strong> from when my server had been instantiated to when it was compromised. It had happened shortly after I'd logged out.</p>
<p>Immediately I felt terrible for falling victim to such a simple, brute-force attack, and the experience has been one of those that makes me appreciate the often painful security hoops we sometimes need to jump through as developers.</p>
<h3>Lessons Learned</h3>
<p>Having fallen prey to what was likely a simple brute-force attack on my root account, I promised myself that I would never again fall prey to such an attack. Now, whenever I set up a server I always set aside plenty of time to do so, use long and complex passwords, disable root logins over SSH, and follow <a href="https://www.linode.com/docs/guides/set-up-and-secure/">that Linode guide</a> I mentioned earlier. Other experiences, like those with spambots, have made me more cautious and careful about the functionality my sites expose and how they expose it (Pine.blog doesn't offer free blogging &amp; image uploads for a reason).</p>
<p><img src="/images/blog/keychain-access.png" alt="Keychain can generate long passwords easily" style="padding:0;margin:auto;" />
<caption><center><small>Keychain can generate long passwords easily, though I wish it could make even longer ones.</small></center></caption></p>
<p>All in all, I count myself unlucky that I had to learn my lesson this way, but I count myself very lucky that I learned it by losing control of an unimportant and trivially replaceable server.</p>
<p>The internet is a very hostile place to those who aren't prepared for it. This is true on a societal level, and on a technical one. If you ever need a reminder of just how dangerous it is, try having <a href="https://www.linode.com/docs/guides/using-fail2ban-to-secure-your-server-a-tutorial/">Fail2Ban</a> email you whenever it blocks a hostile IP address or watch your access logs for bots trying to break into your site (usually using maliciously crafted Wordpress/Drupal URLS). Things like that happen all day, every day; we just don't usually see them.</p>
<p>Anyway, that's the story. Hopefully everyone reading this takes it to heart so that this story remains but a cautionary tale and nothing more.</p>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/hacks-can-be-good-code-too/" class="u-url p-name">
                Hacks Can Be Good Code Too
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-03-21T21:45:00-08:00">
                Posted on Mon, 21 Mar 2022 at 09:45 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <style>
table {
    width: 100%;
}
table td {
    padding: 2px;
    padding-right: 1.5rem;
}
table tr td:last-child {
    padding: 0;
}
</style>

<p>Writing code is, like everything in life, all about making tradeoffs. Code can be quick to write, but at the same time unreadable; it can be fast, but hard to maintain; and it can be flexible, but overly complex. Each of these factors are worth considering when writing Good Code. Complicating this is the fact that: what constitutes Good Code in one situation may not be ideal in another.</p>
<p>Good Code is not universally so.</p>
<p>It is incredibly difficult to explain why one set of tradeoffs are worth pursuing in one case but not in another, and often times reasonable people will disagree on the value of certain tradeoffs over others. Perhaps a snippet of hacky string parsing is good in one place, but not in another. Often times, the most significant cost of solving a problem "The Right Way" is time.</p>
<p>When deciding whether to do something The Right Way or to cheat and simply hack something together, I often try to consider the exposure the given code will have. Consider these questions:</p>
<ul>
<li>Do other systems touch this code?</li>
<li>How many developers will need to interact with it over time?</li>
<li>How much work would be involved in building out the correct approach?</li>
<li>How much work would be involved in building out the bad approach?</li>
<li>How valuable is the intended feature?</li>
<li>How much additional maintenance does the bad solution require?</li>
</ul>
<p>Each of these answers helps me decide what kind of code I should write. These questions neglect multiple other factors (e.g. performance, readability), but they are a good starting point.</p>
<p>In a recent example I needed to modify the blog engine that powers this site as well as a few others. I wanted a simple feature that would count the number of articles on the side as well as the total number of words in every blog post, and display those values on the home page. <a href="/archive/the-new-new-cms/">As I've said before</a> the blog engine for this site is very old, and has been <a href="/archive/smaller/">rewritten</a> <a href="/archive/rewritten/">several</a> <a href="/archive/thinking-about-redoing-my-blog-engine/">times</a>. It's well beyond needing a massive rewrite, but that's not something I really want to do right now.</p>
<p>The blog engine is written in Python, provides a command-line interface, and uses Git Hooks both client and server-side to build and deploy itself.</p>
<p>I originally considered writing this feature in Python: counting the number of words in each article, adding a new context variable to the template rendering process, and then rendering the pages as normal. But that would require touching substantial pieces of the codebase (some of which <a href="/archive/i-solved-the-same-bug-twice-and-didnt-know-it/">I no longer understand</a>). It would probably take me all evening to dive into the code, understand it, make the change, and test it. To be honest, this feature was not worth wasting an evening on. So I decided to just hack something.</p>
<p>As I said, I use Git to deploy the site. So I just added a new line to the HTML template:</p>
<pre><code class="html">
&lt;p&gt;
    This site contains <code>{+ARTICLE_COUNT+}</code>
    different writings and <code>{+WORD_COUNT+}</code>
    total words. That's about <code>{+PAGE_COUNT+}</code>
    pages!
&lt;/p&gt;
</code></pre>

<p>And then I added a new step to the pre-commit hook that runs after the template rendering process, but before the changes are committed and the site is deployed.</p>
<pre><code class="bash">
WPP=320
WORDS_N="$(find archive/ -name "*.md"|xargs -I {} cat {} | wc -w)"
WORDS=`printf "%'d" $WORDS_N`
ARTICLES=`printf "%'d" $(find archive/ -name "*.md" | wc -l)`
PAGES="$(( WORDS_N / WPP ))"

TMP_HOME=`mktemp`
cp ./index.html $TMP_HOME
cat $TMP_HOME |
    sed "s/{+ARTICLE_COUNT+}/$ARTICLES/" |
    sed "s/{+PAGE_COUNT+}/$PAGES/" |
    sed "s/{+WORD_COUNT+}/$WORDS/" > ./index.html
</code></pre>

<p>Let's check in and see how this hack fit my criteria above:</p>
<table border="1" frame="hsides" rules="rows" style="margin-right:auto;margin-left:auto;">
    <tr>
        <td>Do other systems touch this code?</td>
        <td>No</td>
    </tr>
    <tr>
        <td># of Developers?</td>
        <td>1</td>
    </tr>
    <tr>
        <td>Time for Correct Approach?</td>
        <td>2-3 hours</td>
    </tr>
    <tr>
        <td>Time for Bad Approach?</td>
        <td>10 minutes</td>
    </tr>
    <tr>
        <td>How Valuable is the Feature?</td>
        <td>Very</td>
    </tr>
    <tr>
        <td>Additional Maintenance Burden?</td>
        <td>Not much</td>
    </tr>
</table>

<p>Is this elegant: absolutely not. Did it take basically zero time? Yes. Have I thought about it since? Not until writing this post. Would I have done this on a team project or a commercial product? Absolutely not. It's a feature for my personal blog engine and a feature that is specific to one particular low-value site that I run.</p>
<p>In this case, a hack is an example of Good Code. That's because Good Code is a relative construct.</p>
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script></p>
<script>hljs.initHighlightingOnLoad();</script>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/at-vs-on-a-story-of-semantic-data-modeling/" class="u-url p-name">
                At Vs. On: A Story Of Semantic Data Modeling
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-02-21T22:50:00-08:00">
                Posted on Mon, 21 Feb 2022 at 10:50 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>As most good software developers eventually learn: time is hard. Time-based bugs are incredibly common and are sometimes difficult to solve. There are a <a href="https://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time">ton of misconceptions about how time and dates work</a> in the real world and the simple solution is rarely correct for any significant length of time. Performing calculations based on times and dates can get messy, but so can simply storing them. There's a lot to be wary of when building out a data model with timestamps involved, and as always, a lack of consistent naming can cause a ton of problems.</p>
<p>Over the years I've come to use a specific terminology for dates and time in my data models. In general, I prefer not to use data types in variable names, and I prefer my code to read as passable English where possible. This means, I tend to avoid names like: <code>date_created</code> or <code>published_ts</code> which contain the data type in the name, and I avoid names like: <code>created</code> which give me absolutely no indication of the type or what it is used for.</p>
<p>Instead, I prefer to take cues from the English language. For timestamps or any data type that represents a precise moment in time, I use the suffix <code>at</code>. For dates or times that represent more abstract things like wall time or calendar dates, I use the suffix <code>on</code>.</p>
<p>As an example let's say I have the following data model:</p>
<pre><code>class BlogPost:

    # ... other fields ...

    created_at = TimestampField()
    updated_at = TimestampField()

    posted_on = DateField()
</code></pre>
<p>This convention tells me that I should expect the <code>posted_on</code> field to contain a date or time but not both, and that it represents an abstract notion of time, whereas both the <code>created_at</code> and <code>updated_at</code> fields represent a specific moment.</p>
<p>I arrived at this convention through asking myself questions about the data in plain English. Consider the following questions:</p>
<ol>
<li>Q: When was this post published?<br />
A: It was published <strong>on</strong> the 25th of January.</li>
<li>Q: When was the post record created?<br />
A: It was created <strong>at</strong> 12:00 PM on January 24th.</li>
</ol>
<details><summary>Disclaimer</summary>
This convention doesn't always work because usually people would use <b>at</b> to describe any time (e.g. "I arrived <b>at</b> noon"). But once I settled on the convention, it wasn't confusing. It just doesn't always read nicely.
</details>

<p>Knowing when to use a timestamp vs. a calendar date or wall-clock time is another issue (and a complicated one), but at least with this convention, I know which one I'm dealing with.</p>
<div class="footnote">
Now that I think about it, it might make sense to name timestamps with an <b>aton</b> suffix since question #2 technically uses both <b>at</b> and <b>on</b>.
</div>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/generating-deterministic-procedural-artwork-with-pdraw/" class="u-url p-name">
                Generating Deterministic, Procedural Artwork With Pdraw
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-02-18T22:36:00-08:00">
                Posted on Fri, 18 Feb 2022 at 10:36 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>I've been messing with procedural artwork lately, and I've decided to discuss the fruits of my labor. Behold <a href="https://github.com/Sonictherocketman/pdraw">pdraw</a>: a script that generates cool line art from arbitrary text!</p>
<p><a href="https://github.com/Sonictherocketman/pdraw"><img class="image-right" src="/images/blog/pdraw.gif" alt="Pdraw.py" style="max-width: 300px;" /></a></p>
<p>About two weeks ago, <a href="https://www.youtube.com/watch?v=tkC1HHuuk7c">Numberphile</a> released a new video about visualizing the digits of Pi using procedural artwork. I was taken by the idea and decided that I would, for fun, simply replicate their technique in Python and use it to plot random sections of Pi. It was a sort of goof-off project to occupy an evening. At the end of that evening, I had finished my script (through several iterations) and plotted various sections of Pi. I could now plot any stream of numbers. Then it hit me: all digital data can be represented as a base 10 string of numbers. I could draw anything.</p>
<p>The next evening, I set about making it so that my script could accept various command-line configurations and convert any text into its base 10 equivalent (with a small tweak for artistic reasons). Once I had that, it was time to start plotting anything I could think of. I've tried drawing binaries, zip files, websites, and a lot more.</p>
<p>I've <a href="https://github.com/Sonictherocketman/pdraw">open sourced</a> the code for pdraw &mdash; which uses no dependences because Python is cool like that &mdash; so you the technically inclined reader can draw your very own text streams and see if they produce anything interesting.</p>
<p>I've found that the cooler drawings tend to arise from text containing between 250-2000 characters, although larger files can be cool too. What's especially interesting is that you can almost see the structure of the data in the drawing as you watch it draw. For example, my blog archive page is basically a blob of header information, then a long and repetitive HTML table, and then another blob. This structure appears in the drawing when you plot the HTML of the page; the table rows appearing as little loops followed by lines in random directions.</p>
<p><code>$ curl https://brianschrader.com/archive/ | ./pdraw -e</code></p>
<p>Check it out, and let me know what you do with it. I'd love to know if anyone finds more cool things to do with pdraw, or if you generate some particularly cool drawings with it.</p>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/i-solved-the-same-bug-twice-and-didnt-know-it/" class="u-url p-name">
                I Solved The Same Bug Twice And Didn't Know It
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-02-01T23:44:00-08:00">
                Posted on Tue, 01 Feb 2022 at 11:44 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>Human memory is incredibly lossy; the brain an imperfect storage medium.</p>
<p>I've <a href="/archive/comments-with-cited-references/">written before</a> about how I include links in my code comments to resources that helped me find unintuitive or convoluted solutions. These links are essentially the footnotes of my systems; both documentation and a debugging paper-trail for poor, future souls to follow.</p>
<p>However, I am an imperfect soul, and so not all of my hackish solutions are cited. This fact bit me the other day when I discovered a strange bug with a new feature in <a href="https://adventurerscodex.com/">Adventurer's Codex</a>.</p>
<h3>The Technical Details</h3>
<p>The actual issue was fairly nuanced and understanding it depends heavily on the details of our infrastructure, but the simple version goes like this:</p>
<p>We have two endpoints, one that returns a resource and one that returns the schema for our entire API. For whatever reason, in this particular case, requesting the resource changed the output of the schema the first time the resource was requested. This is obviously unexpected. The structure of an API shouldn't change when you call it right? Well, that's the thing. Technically the API wasn't actually changing, but the schema was ever so slightly different: the format of the schema for that resource had changed.</p>
<p><img
    alt="A funny joke"
    src="/images/blog/changed-outcome.jpg"
    class="image-right"
    style="max-width:320px;"
/></p>
<p>The schema is a hierarchical description of all of our API endpoints, with paths to describe how each resource is related. In this case, the schema would output two different paths to the same resource, but the data at both paths were identical.</p>
<p>For technical reasons, these paths matter to us. <strong>They must remain the same.</strong></p>
<h3>Following the Breadcrumb Trail</h3>
<p>After some DuckDuckGo-fu failed to turn up any useful results, I turned to the rest of the codebase. The problematic endpoint was very simple. Surely we'd implemented other similar functionality which didn't cause this behavior. Sure enough I found two such cases. Both of which contained the same strange, seemingly useless line of code.</p>
<p>Once I had added that seemingly useless code, the schema no longer changed. I had fixed the bug! I had discovered <em>how</em> to fix the bug, but not <em>why</em>. I could have stopped there. Someone else might have, but I needed to go further. I needed to find out how this unrelated line solved my problem.</p>
<p>For now, I had found a clue.</p>
<p>Being the primary author of this particular codebase I knew that such a strange implementation would probably have at least a code comment or a comment in the implementing commit that explained the weirdness. There was no code comment unfortunately, and neither was there one in the commit. However, by diving through the history of that particular file I found that there had been a code comment, right where I would have expected it to be, when the code was written; but it had been removed in another commit a few months back&mdash;<em>by me</em>.</p>
<p><img
    alt="The Fatefult Commit"
    src="/images/blog/ac-fateful-comment.png"
    class="image-center"
/></p>
<p>Unfortunately, the comment didn't link to an answer on the internet and subsequent searches have turned up nothing of use.</p>
<p>For now, I had found another clue&mdash;and a big one at that. I had also discovered something scarier: I had already found, fought, and beaten this bug before, and it was I that deleted the vital clue.</p>
<p>I had discovered that I was not just the detective but the victim and the murderer, and that the case had been closed three years prior.</p>
<h3>Answers Lost to the Mists of Time</h3>
<p>As strange as it may seem, I find that this kind of thing happens more often than we may like to admit. I am in a situation where I maintain most of the code I write, and so I get to live with my mistakes for years&mdash;going on a decade now. When I wrote the offending code and the comment that explained it, I was deep in the bowels of <a href="https://www.django-rest-framework.org">DRF</a> building out the Adventurer's Codex backend from whole cloth. Since then I've moved on to building other things. That code has now sat for years untouched, working as designed; and <a href="https://www.goodreads.com/quotes/376870-and-some-things-that-should-not-have-been-forgotten-were">some things which should not have been forgotten were lost</a>.</p>
<p>At time of writing this mystery is still unsolved; the clues leading to an end I cannot see. However I now know that at one point in the past I did know the cause of this issue and how to solve it. The solution lives on, but <a href="/archive/where-it-comes-from-nobody-knows/">the cause is lost</a>: a coder's <a href="https://en.wikipedia.org/wiki/Greek_fire">greek fire</a>.</p>
<p>The answer may be lost to time, as even three years is enough time for some links to rot and trails to run cold. In what now feels like another lifetime, a past version of myself held the answers I now seek. Perhaps one day a Future Me will know what Past Me had found.</p>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/take-a-break-script-something/" class="u-url p-name">
                Take A Break, Script Something
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2022-01-03T04:58:00-08:00">
                Posted on Mon, 03 Jan 2022 at 04:58 AM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>Lately I've been putting in a fair amount of work improving Adventurer's Codex, and we have some very exciting updates coming soon (no spoilers 🤫). A lot of the changes required modifying our existing single-page app or API backend, but one involved the creation of a totally new repository and a new set of public-facing pages. It's those pages that I want to talk about.</p>
<p>The problem was fairly simple: given a set of data that changes very infrequently, create a set of web pages that display the details of each record in the dataset. Simple right?</p>
<p>Now, there's two ways I could have built out this functionality:</p>
<ol>
<li>Dynamic pages that serve the content using templates served by Django</li>
<li>Static pages built once and served by Nginx</li>
</ol>
<details>
  <summary>Additional Context</summary>
  <p>I wanted this functionality to be separate from our main project, so the first solution would involve setting up a new Django app and database as well as building a system to import the data from JSON files.</p>
</details>

<p>I elected to do the second solution because of it's simplicity and because the data changes so rarely. When all was said and done, I had three scripts &mdash; two bash scripts, and one Python script &mdash; and a set of <a href="https://jinja.palletsprojects.com/en/3.0.x/">Jinja templates</a>. Running the main build script would download the dataset if it didn't already exist, parse the data, and build the pages. The whole process takes about 10 seconds to download and generate over 1200 pages. After it was done, I even set up a Docker container to build and serve the pages with Nginx. In total the project is 295 lines of code (1k if you include the HTML templates), and basically never needs to be updated again; if the data does ever change, we could simply re-run the script or rebuild the contaner.</p>
<h2>Scripting is a Much-Needed Break</h2>
<p>This is one thing I love about scripting as opposed to application development. In app development, you construct a codebase and then you need to live with it long term, adding new functionality and deprecating old functionality. Scripts, on the other hand, are low risk, high reward: you write them once to solve a specific problem and then rarely touch them again. I use a lot of simple scripts on a daily basis, some of which I wrote nearly a decade ago and haven't touched since.</p>
<p>Scripts are programming candy whereas app development is the real meat and potatoes. In a script you can take shortcuts, be a bit messy, and forgo worrying about the complexities of large software. Once the script works, there's not much else to do: just ship it.</p>
<p>Whenever I get the chance to take a break from developing large apps and just do some quick scripting, I leap at the opportunity.</p>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/the-road-to-glass--stone/" class="u-url p-name">
                The Road To Glass & Stone
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2021-12-07T21:11:00-08:00">
                Posted on Tue, 07 Dec 2021 at 09:11 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>I don't think I've ever talked about this here before, but I play in a band. And that band, <a href="https://thefourthsection.com">The Fourth Section</a>, just released its first EP, 'Glass &amp; Stone'; and it's available now.</p>
<p>It's been almost two years since we formed, just before lockdown in March of 2020, so technically this is our pandemic EP. I'm super happy that we've finally gotten a release out there and available for everyone.</p>
<p><a href="https://thefourthsection.com"><img
    src="/images/blog/glass_and_stone.png"
    alt="Glass & Stone"
    class="image-center"
/></a></p>
<p>I've released music on Bandcamp before, but this is the first time that I'd ever gone through the process of getting music onto the big platforms. It's both a time-consuming process, and still incredible that a bunch of indie artists, with no label backing, can simply fill out some paperwork and then distribute music world wide. We often lose sight of it, but the internet is really magical sometimes.</p>
<p>The EP was recorded, mixed, and mastered at <a href="https://www.cachoestudio.com">Cacho Studio</a> in Tijuana, and they did a great job. My thanks to everyone at the studio for their hard work.</p>
<h2>A Virtual and Untrodden Road</h2>
<p>Since we formed right before the pandemic lockdowns hit the U.S., we couldn't practice at a studio in-person at first. For nearly a year we rehearsed virtually or acoustically&mdash;as well as masked and social distanced&mdash;at a local park. The three of us used <a href="https://jamkazam.com">Jamkazam</a> for our virtual practices and it works well enough for that purpose, but it's no substitute for actual, plugged-in rehearsal at a practice studio.</p>
<p>We're back to in-person rehearsal now, and it feels great. Lots of new stuff is in the works and hopefully there will be more to show in the coming months.</p>
<p>Having gone through the process of writing, composing, and distributing music once, we now have a pretty good idea of what it takes to make an EP (or an album) happen, and we're really stoked to do this whole process again (and soon). As with most things, the first try is usually the hardest. There's always the initial, one-time setup that has to be done, and there's just so much you don't know the first time. That is all past now. We know what it takes, and the setup is done. Releasing more stuff is a lot easier now.</p>
<p>And that is what we plan to do.</p>
          </div>
        </div>
      </article>
      
      <article>
        <div class="post h-entry">
          <div class="article-title">
            <h1><a href="/archive/nine9s-gets-an-upgrade-/" class="u-url p-name">
                Nine9s Gets An Upgrade ⬆️
              </a>
            </h1>
            <small style="font-style:italic;">
              <time class="dt-published" datetime="2021-12-06T18:28:00-08:00">
                Posted on Mon, 06 Dec 2021 at 06:28 PM
              </time>
            </small>
          </div>
          <div class="article-content e-content">
            <p>I'm super excited to announce a new suite of features for <a href="https://nine9s.cloud/">Nine9s: my uptime monitoring service</a>. Now, I don't want to exaggerate too much, but I honestly thing that as of today, Nine9s is one of the most powerful uptime monitoring services out there; if you haven't already, you should try it out.</p>
<h2>Monitor Anything</h2>
<p>Uptime monitoring, in most cases is a pretty simple task: if you have a web service, then Nine9s makes a request to it, and verifies that it returns a successful HTTP status code. Most services stop there, or they expand on the idea and allow for checks to be more complex (e.g. verifying that elements exist on the page or that users can log in).</p>
<p>The problem with this approach is that lots of services exist on the web, but do things other than simply serve web content. You could have a service that sends emails or that runs batch jobs. These services can't be monitored using simple HTTP requests. Even still, sometimes you don't want your services to be publicly accessable, in which case uptime monitoring services can't reach out to them at all.</p>
<p>That's where Nine9s steps in to fill the gap! As of today, servers can now periodically ping Nine9s to report that they're still up and running. Nine9s will watch out for these reports and let the user know if the service doesn't report in within a given amount of time.</p>
<p>Better still, Nine9s can evaluate the data sent by the server and compare it against some criteria. Imagine you have your server report its current disk usage to Nine9s. If the disk ever fills up past say 95%, then Nine9s will alert you immediately.</p>
<p><img alt="Example Criteria on Nine9s" src="/images/blog/nine9s-criteria.png" /></p>
<p>When you set up a new Measure&mdash;which is what Nine9s calls these new features&mdash;Nine9s will generate a couple of sample cron jobs you can quickly add to your servers to get started! There's even a <a href="https://nine9s.cloud/kb/measurement-snippets">quickstart guide</a> to writing additional jobs!</p>
<p><img alt="Sample Cron Scripts" src="https://nine9s.cloud/static/kb/cron.png" /></p>
<p>Once you understand the power of these new Measures, you'll be able to monitor nearly anything your servers are doing and make sure they're performing as expected.</p>
<h2>Nine9s is macOS Native!</h2>
<p>This release also marks the launch of the <a href="https://nine9s.cloud/#app">official Nine9s app for macOS!</a> It's my first ever public macOS app and I'm super excited to get it out there into the world. The app shares all of its code with the iOS and iPad versions  and is built on Catalyst, so it should feel <em>mostly</em> native.</p>
<p>The app has all of the features you'd imagine: the ability to monitor your Endpoints and Measures, support for push notifications, and more.</p>
<p>The app is also my first ever native app released outside of the App Store!</p>
<p>I've been working on this update for a few months now and I'm stoked to get it into the hands of all you out there! If you do end up downloading the app, let me know especially if you have feature recommendations! I'd also love to know how you all are using Measures in the wild.</p>
          </div>
        </div>
      </article>
      
    </div>
    <div class="side-bar">
      <div class="promotion">
  <div data-sublime-embed="oKLwqL0q2k9NOA"></div>
  <script src="https://embed.sublimeads.com/embed.js" defer></script>
</div>
<h4>Featured Posts</h4>
<ul>
  
  <li><a href="/archive/grove/" title="Grove, a new Tree-planting Wellness Game 🎉" rel="nofollow">
    Grove, a new Tree-planting Wellness Game 🎉
  </a></li>
  
  <li><a href="/archive/announcing-hewell-public-beta-/" title="Announcing: Hewell Public Beta 🎉" rel="nofollow">
    Announcing: Hewell Public Beta 🎉
  </a></li>
  
  <li><a href="/archive/on-uber-lyft-and-labor-law/" title="On Uber, Lyft, and Labor Law" rel="nofollow">
    On Uber, Lyft, and Labor Law
  </a></li>
  
  <li><a href="/archive/d20photos-a-public-domain-dd-image-repository/" title="d20.photos: A Public Domain D&amp;D Image Repository" rel="nofollow">
    d20.photos: A Public Domain D&amp;D Image Repository
  </a></li>
  
  <li><a href="/archive/announcing-nine9scloud-/" title="Announcing Nine9s.cloud 🎉" rel="nofollow">
    Announcing Nine9s.cloud 🎉
  </a></li>
  
  <li><a href="/archive/why-were-polarized/" title="Why We&#39;re Polarized" rel="nofollow">
    Why We&#39;re Polarized
  </a></li>
  
  <li><a href="/archive/a-new-adventure/" title="A New Adventure" rel="nofollow">
    A New Adventure
  </a></li>
  
  <li><a href="/archive/the-social-web/" title="The Social Web" rel="nofollow">
    The Social Web
  </a></li>
  
  <li><a href="/archive/feed-readers-and-local-news/" title="Feed Readers and Local News" rel="nofollow">
    Feed Readers and Local News
  </a></li>
  
  <li><a href="/archive/the-web-as-a-social-network/" title="The Web as a Social Network" rel="nofollow">
    The Web as a Social Network
  </a></li>
  
</ul>
<h4>Recent Posts</h4>
<ul>
  
  <li><a href="/archive/using-pushover-for-super-simple-sysadmin-alerts/" title="Using Pushover for Super Simple SysAdmin Alerts" rel="nofollow">
    Using Pushover for Super Simple SysAdmin Alerts
  </a></li>
  
  <li><a href="/archive/crossing-the-wording-threshold/" title="Crossing the Wording Threshold" rel="nofollow">
    Crossing the Wording Threshold
  </a></li>
  
  <li><a href="/archive/that-time-i-lost-control-of-a-server/" title="That Time I Lost Control of a Server" rel="nofollow">
    That Time I Lost Control of a Server
  </a></li>
  
  <li><a href="/archive/hacks-can-be-good-code-too/" title="Hacks can be Good Code Too" rel="nofollow">
    Hacks can be Good Code Too
  </a></li>
  
  <li><a href="/archive/at-vs-on-a-story-of-semantic-data-modeling/" title="At vs. On: a Story of Semantic Data Modeling" rel="nofollow">
    At vs. On: a Story of Semantic Data Modeling
  </a></li>
  
  <li><a href="/archive/generating-deterministic-procedural-artwork-with-pdraw/" title="Generating Deterministic, Procedural Artwork with pdraw" rel="nofollow">
    Generating Deterministic, Procedural Artwork with pdraw
  </a></li>
  
  <li><a href="/archive/i-solved-the-same-bug-twice-and-didnt-know-it/" title="I Solved The Same Bug Twice And Didn&#39;t Know It" rel="nofollow">
    I Solved The Same Bug Twice And Didn&#39;t Know It
  </a></li>
  
  <li><a href="/archive/take-a-break-script-something/" title="Take a Break, Script Something" rel="nofollow">
    Take a Break, Script Something
  </a></li>
  
  <li><a href="/archive/the-road-to-glass--stone/" title="The Road to Glass &amp; Stone" rel="nofollow">
    The Road to Glass &amp; Stone
  </a></li>
  
  <li><a href="/archive/nine9s-gets-an-upgrade-/" title="Nine9s gets an upgrade ⬆️" rel="nofollow">
    Nine9s gets an upgrade ⬆️
  </a></li>
  
</ul>
<h4>Also Me</h4>
<ul>
  <li><a href="http://pine.blog/u/sonicrocketman" title="Pine.blog" rel="nofollow me">
    Pine.blog
  </a></li>
  <li><a href="https://github.com/sonictherocketman/" title="GitHub" rel="nofollow me">
    GitHub
  </a></li>
  <li><a href="https://twitter.com/sonicrocketman" title="Twitter" rel="nofollow me">
    Twitter
  </a></li>
  <li><a href="//pinboard.in/u:sonicrocketman/public/" title="Pinboard" rel="nofollow me">
    Pinboard
  </a></li>
  <li><a href="http://photos.brianschrader.com" title="My Photoblog" rel="nofollow me">
    Photoblog
  </a></li>
  <li><a href="https://en.gravatar.com/sonicrocketman" title="Gravatar" rel="nofollow me">
    Gravatar
  </a></li>
  <li><a href="https://sonicrocketman.bandcamp.com" title="Bandcamp" rel="nofollow me">
    Bandcamp
  </a></li>
  <li><a href="https://www.goodreads.com/user/show/119559749-brian-schrader" title="Goodreads" rel="nofollow me">
    Goodreads
  </a></li>
</ul>
<h4>Projects</h4>
<ul>
  <li><a href="http://democracyandprogress.com" title="Democracy and Progress">
    Democracy &amp; Progress
  </a></li>
  <li><a href="https://goingindie.tech" title="Going Indie">
    Going Indie
  </a></li>
  <li><a href="https://pine.blog" title="Pine.blog" rel="nofollow">
    Pine.blog
  </a></li>
  <li><a href="https://indiedevlife.fm" title="Indie Dev Life Podcast">
    Indie Dev Life Podcast
  </a></li>
  <li><a href="https://nine9s.cloud" title="Nine9s" rel="nofollow">
    Nine9s
  </a></li>
  <li><a href="https://d20.photos" title="d20.photos" rel="nofollow">
    d20.photos
  </a></li>
  <li><a href="https://adventurerscodex.com" title="Adventurer's Codex" rel="nofollow">
    Adventurer&apos;s Codex
  </a></li>
</ul>
<h4>Resources</h4>
<ul>
  <li><a href="/archive/bibliography" title="Bibliography">
    Bibliography
  </a></li>
  <li><a href="/archive/bookshelf" title="Book Recommendations">
    Book Recommendations
  </a></li>
  <li><a href="/archive/recipes/" title="Food and Drink Recipes">
    Food &amp; Drink Recipes
  </a></li>
  <li><a href="/tags.html" title="Posts by Tag">
    Tags
  </a></li>
</ul>
<h4>Tags</h4>
<div class="tags">
  
    <a href="/tags.html#tag-programming" title="programming" class="tag">programming</a>,
  
    <a href="/tags.html#tag-software development" title="software development" class="tag">software development</a>,
  
    <a href="/tags.html#tag-software" title="software" class="tag">software</a>,
  
    <a href="/tags.html#tag-blogging" title="blogging" class="tag">blogging</a>,
  
    <a href="/tags.html#tag-pine.blog" title="pine.blog" class="tag">pine.blog</a>,
  
    <a href="/tags.html#tag-open web" title="open web" class="tag">open web</a>,
  
    <a href="/tags.html#tag-development" title="development" class="tag">development</a>,
  
    <a href="/tags.html#tag-politics" title="politics" class="tag">politics</a>,
  
    <a href="/tags.html#tag-python" title="python" class="tag">python</a>,
  
    <a href="/tags.html#tag-history" title="history" class="tag">history</a>
  
</div>
<h4>Blogroll</h4>
<ul>
  <li><a href="https://vincentritter.com/" title="Vincent Ritter" rel="nofollow">
    Vincent Ritter
  </a></li>
  <li><a href="https://gregorlove.com/" title="gRegorLove.com" rel="nofollow">
    gRegorLove.com
  </a></li>
  <li><a href="https://eli.li/" title="Oatmeal" rel="nofollow">
    Oatmeal
  </a></li>
  <li><a href="https://aaronparecki.com/" title="Aaron Parecki" rel="nofollow">
    Aaron Parecki
  </a></li>
  <li><a href="http://inessential.com/" title="inessential" rel="nofollow">
    inessential
  </a></li>
  <li><a href="http://idlewords.com/" title="Idle Words" rel="nofollow">
    Idle Words
  </a></li>
  <li><a href="http://macgenie.micro.blog/" title="Jean MacDonald" rel="nofollow">
    Jean MacDonald
  </a></li>
  <li><a href="https://www.vox.com/authors/ezra-klein" title="Ezra Klein" rel="nofollow">
    Ezra Klein
  </a></li>
  <li><a href="https://pine.blog/u/photosaboutadams" title="Photos About Adams" rel="nofollow">
    Photos About Adams
  </a></li>
  <li><a href="https://iifrp.org" title="IIFRP.org" rel="nofollow">
    IIFRP.org
  </a></li>
  <li><a href="http://mattgemmell.com/" title="Matt Gemmell" rel="nofollow">
    Matt Gemmell
  </a></li>
  <li><a href="http://hypercritical.co/" title="Hypercritical" rel="nofollow">
    Hypercritical
  </a></li>
  <li><a href="https://twitter.com/HelloMelanieC" title="Melanie Crutchfield" rel="nofollow">
    Melanie Crutchfield
  </a></li>
  <li><a href="http://jvns.ca/" title="Julia Evans" rel="nofollow">
    Julia Evans
  </a></li>
  <li><a href="https://kateheddleston.com/blog" title="Kate Heddleston" rel="nofollow">
    Kate Heddleston
  </a></li>
  <li><a href="https://beckyhansmeyer.com/" title="Becky Hansmeyer" rel="nofollow">
    Becky Hansmeyer
  </a></li>
  <li><a href="https://adventurerscodex.com/blog.html" title="Adventurer's Codex Blog" rel="nofollow">
    Adventurer's Codex Blog
  </a></li>
  <li><a href="https://blog.pine.blog/" title="Pine.blog Official Blog" rel="nofollow">
    Pine.blog Official Blog
  </a></li>
  <li><a href="https://www.peoplespolicyproject.org/" title="People's Policy Project" rel="nofollow">
    People's Policy Project
  </a></li>
</ul>
    </div>
  </div>
  <div class="h-card p-author" style="display:none;">
    <img
      class="u-photo"
      src="https://www.gravatar.com/avatar/11b074a636e00292c98e3e60f7e16595"
    />
    <span class="p-name">Brian Schrader</span>
    <span class="p-nickname">sonicrocketman</span>
    <a href="/" class="u-url u-uid"></a>
  </div>
  <div class="footer">
    <hr />
    <small>
      Other Links:
      <span class="article-content"><a rel="alternate" href="/rss.xml">RSS Feed</a></span>,
      <span class="article-content"><a rel="alternate" href="/feed.json">JSON Feed</a></span>,
      <span class="article-content">
        <a
          rel="status"
          href="https://nine9s.cloud/s/e/74b2b428-f6b8-4c3f-bf9f-4d4b21404578"
          target="_blank"
        >
          Status Page &#8594;
        </a>
      </span>
    </small>
  </div>

    </div>
  </body>
</html>