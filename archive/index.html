<?php
$json_str = file_get_contents("metadata.json");
$json = json_decode($json_str, true);
$articles = $json['articles'];
$collections = $json['collections'];
$other = $json["other"];
?>

<!DOCTYPE HTML>
<html>
<head>
<title>Archive - BiteofanApple</title>
<?php include($_SERVER['DOCUMENT_ROOT'] . "/bin/header-template.html"); ?>
</head>
<body>
<div id="content">
	<div id="title-bar">
		<?php include($_SERVER['DOCUMENT_ROOT'] . "/bin/title-bar-template.html"); ?>
	</div>
	<div id="post-list">
		<div class="post">
			<div class=article-title>
				<h1>Articles</h1>
			</div>
			<div class="article-content">
				<table style="margin-right:auto; margin-left:auto;">
				<?php for($i = $articles-1; $i >= 0; $i--) { 
					$path = $_SERVER['DOCUMENT_ROOT'] . $json['path'.$i] . "metadata.json";
					$foo = file_get_contents($path);
					$articleJson = json_decode($foo, true);
				?>
					<tr>
						<td>
							<small style="font-style:italic;">
							<?php
								echo($articleJson['published']);
							?>
							</small>
						</td>
						<td>&nbsp;&nbsp;</td>
						<td> 
							<?php 
								echo("<a href=".$articleJson['link'].">");
								echo($articleJson['title']."</a>");
							?>
						</td>
					</tr>
				<?php } ?>
				</table>
			</div>
		</div>
		<div class="post">
			<div class=article-title>
				<h1>Image Collections</h1>
			</div>
			<div class="article-content">
				<table style="margin-right:auto; margin-left:auto;">
				<?php
					foreach(array_keys($collections) as $key) {
						$foo = json_decode(file_get_contents($_SERVER['DOCUMENT_ROOT']."/".$collections[$key]."/metadata.json"), true);
				?>
					<tr>
						<td>
							<?php echo("<a href=\"http://brianschrader.com/".$collections[$key]."\">".$foo['title']."</a>"); ?>
						</td>
					</tr>
				<?php
					}
				?>
				</table>
			</div>
		</div>
		<div class="post">
			<div class=article-title>
				<h1>Other Things</h1>
			</div>
			<div class="article-content">
				<table style="margin-right:auto; margin-left:auto;">
				<?php
					foreach($other as $post) {
						$foo = json_decode(file_get_contents($_SERVER['DOCUMENT_ROOT'].$post."/metadata.json"), true);
				?>
					<tr>
						<td>
							<?php echo("<a href=\"".$post."\">".$foo['title']."</a>"); ?>
						</td>
					</tr>
				<?php
					}
				?>
				</table>
			</div>
		</div>
		<?php include ($_SERVER['DOCUMENT_ROOT'] . "/bin/footer.html");?>
	</div>
</div>
</body>
</html>